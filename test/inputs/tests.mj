mux_n<n, p>(switch:[n], cases:[2^n, p]) = o:[_] where
    if n = 0 then
        o = cases[0];
    else
        o = mux(switch[0], mux_n(switch[1..], cases[..2^n-1]), mux_n(switch[1..], cases[2^n..]));
    end if
end where

(*
main() = () where
  i = [[0b100, 0b001]];
  o = i[0, .. , 0..1];
  a = recursive<4, 2>(0b0101)
end where


fulladder(a,b,c) = (s, r) where
  s = (a xor b) xor c;
  r = (a and b) or ((a xor b) and c)
end where

minus(x) = (y) where
  y = x xor c;
  c = reg (x or y)
end where

cm2(x) = (s, r) where
  s = reg (x xor s);
  r = x and s
end where

clk2() = (o) where
  o = reg(c);
  c = not (reg (o))
end where

recursive<n, p>(i:[n]) = o where
  if p >= n then
    o = i[p-1]
  else
    o = recursive<n, p+1>(i)
  end if
end where
*)
